# *****Components*****
components:
    # Auth schema
    securitySchemes:
        bearerAuth:
            type: http
            scheme: bearer
            bearerFormat: JWT
    # Request examples
    requestBodies:
        RegisterUser:
            type: Object
            properties:
                username:
                    type: String
                email:
                    type: String
                password:
                    type: String
                image:
                    type: String
            example:
                username: admin
                email: email@email.com
                password: Admin123
        LoginUser:
            type: Object
            properties:
                email:
                    type: String
                password:
                    type: String
            example:
                email: email@email.com
                password: Admin123
        UpdateUsername:
            type: Object
            properties:
                username:
                    type: String
            example:
                username: newUsername
        UpdateEmail:
            type: Object
            properties:
                email:
                    type: String
                    description: New email
            example:
                email: new@email.com
        UpdatePassword:
            type: Object
            properties:
                oldPassword:
                    type: String
                    description: oldPass
                newPassword:
                    type: String
                    description: newPass
            example:
                oldPassword: 'OldPassword'
                newPassword: 'NewPassword'
        UpdateImage:
            type: Object
            properties:
                image:
                    type: string
                    format: binary
            example:
                image: FileImage
        Unregister:
            type: Object
            properties:
                password:
                    type: String
            example:
                password: CurrentPassword
    # OK response
    responseBodies:
        UserCreated:
            type: Object
            properties:
                results:
                    type: String
            example:
                results: user created
        LoginToken:
            type: Object
            properties:
                token:
                    type: String
            example:
                token: jwt
        UserProfile:
            type: Object
            properties:
                results:
                    type: Object
            example:
                results:
                    {
                        username: username,
                        email: email,
                        image: image,
                        cart: (uuidV4)
                    }
        UserUpdate:
            type: Object
            properties:
                results:
                    type: Object
            example:
                results: user acepted-updated
    # Error response
    responseErrorBodies:
        Unauthorized:
            type: Object
            properties:
                errors:
                    type: Object
            example:
                errors: user unauthorized
        WrongFields:
            type: Object
            properties:
                errors:
                    type: Array
            example:
                errors: ['Wrong fields...']
        UserConflic:
            type: Object
            properties:
                errors:
                    type: Object
            example:
                errors: user conflict
# *****Paths*****
paths:
    /api/register:
        post:
            summary: Register an user on database
            tags:
                - Users
            requestBody:
                required: true
                content:
                    application/json:
                        schema:
                            $ref: '#/components/requestBodies/RegisterUser'
            responses:
                '201':
                    description: OK (user created)
                    content:
                        application/json:
                            schema:
                                type: object
                                $ref: '#/components/responseBodies/UserCreated'
                '400':
                    description: Invalid Body fields - Bad request
                    content:
                        application/json:
                            schema:
                                type: object
                                $ref: '#/components/responseErrorBodies/WrongFields'
                '409':
                    description: User already exist into DataBase - Conflict
                    content:
                        application/json:
                            schema:
                                type: object
                                $ref: '#/components/responseErrorBodies/UserConflic'
    /api/login:
        post:
            summary: Login user with email & password
            tags:
                - Users
            requestBody:
                required: true
                content:
                    application/json:
                        schema:
                            $ref: '#/components/requestBodies/LoginUser'
            responses:
                '200':
                    description: OK (user logged)
                    content:
                        application/json:
                            schema:
                                type: object
                                $ref: '#/components/responseBodies/LoginToken'
                '400':
                    description: Invalid Body fields - Bad request
                    content:
                        application/json:
                            schema:
                                type: object
                                $ref: '#/components/responseErrorBodies/WrongFields'
                '401':
                    description: Wrong credentials (email|password) - Unauthorized
                    content:
                        application/json:
                            schema:
                                type: object
                                $ref: '#/components/responseErrorBodies/Unauthorized'
    /api/profile:
        get:
            summary: Get User Profile
            tags:
                - Users
            security:
                - bearerAuth: []
            responses:
                '200':
                    description: Get user profile
                    content:
                        application/json:
                            schema:
                                type: object
                                $ref: '#/components/responseBodies/UserProfile'
                '401':
                    description: Invalid token - Unauthorized
                    content:
                        application/json:
                            schema:
                                type: object
                                $ref: '#/components/responseErrorBodies/Unauthorized'
    /api/update-username:
        patch:
            summary: Update user username
            tags:
                - Users
            security:
                - bearerAuth: []
            requestBody:
                required: true
                content:
                    application/json:
                        schema:
                            $ref: '#/components/requestBodies/UpdateUsername'
            responses:
                '202':
                    description: User username updated
                    content:
                        application/json:
                            schema:
                                type: object
                                $ref: '#/components/responseBodies/UserUpdate'
                '400':
                    description: Invalid Body fields - Bad request
                    content:
                        application/json:
                            schema:
                                type: object
                                $ref: '#/components/responseErrorBodies/WrongFields'
                '401':
                    description: Invalid token - Unauthorized
                    content:
                        application/json:
                            schema:
                                type: object
                                $ref: '#/components/responseErrorBodies/Unauthorized'
    /api/update-email:
        patch:
            summary: Update user email
            tags:
                - Users
            security:
                - bearerAuth: []
            requestBody:
                required: true
                content:
                    application/json:
                        schema:
                            $ref: '#/components/requestBodies/UpdateEmail'
            responses:
                '202':
                    description: User email updated
                    content:
                        application/json:
                            schema:
                                type: object
                                $ref: '#/components/responseBodies/UserUpdate'
                '400':
                    description: Invalid Body fields - Bad request
                    content:
                        application/json:
                            schema:
                                type: object
                                $ref: '#/components/responseErrorBodies/WrongFields'
                '401':
                    description: Invalid token - Unauthorized
                    content:
                        application/json:
                            schema:
                                type: object
                                $ref: '#/components/responseErrorBodies/Unauthorized'
    /api/update-password:
        patch:
            summary: Updated user password
            tags:
                - Users
            security:
                - bearerAuth: []
            requestBody:
                required: true
                content:
                    application/json:
                        schema:
                            $ref: '#/components/requestBodies/UpdatePassword'
            responses:
                '202':
                    description: Password user changed
                    content:
                        application/json:
                            schema:
                                type: object
                                $ref: '#/components/responseBodies/UserUpdate'
                '400':
                    description: Invalid Body fields - Bad request
                    content:
                        application/json:
                            schema:
                                type: object
                                $ref: '#/components/responseErrorBodies/WrongFields'
                '401':
                    description: Invalid Credentials|Token - Unauthorired
                    content:
                        application/json:
                            schema:
                                type: object
                                $ref: '#/components/responseErrorBodies/Unauthorized'
    /api/unregister:
        delete:
            summary: Unregister user
            tags:
                - Users
            security:
                - bearerAuth: []
            requestBody:
                required: true
                content:
                    application/json:
                        schema:
                            $ref: '#/components/requestBodies/Unregister'
            responses:
                '204':
                    description: OK (user no-content deleted)
                '400':
                    description: Invalid Body fields - Bad request
                    content:
                        application/json:
                            schema:
                                type: object
                                $ref: '#/components/responseErrorBodies/WrongFields'
                '401':
                    description: Invalid Credentials|Token - Unauthorized
                    content:
                        application/json:
                            schema:
                                type: object
                                $ref: '#/components/responseAndErrors/Unauthorized'
